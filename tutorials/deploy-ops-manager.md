---
title: MongoDBOpsManager Resource
description: This tutorial explains how to create the Ops Manager Custom Resource in Kubernetes.
---
### Create Admin Credentials Secret
Before creating the Ops Manager resource you need to prepare the information about the admin user which will be created automatically in Ops Manager. Execute below command to do it:

```execute
kubectl create secret generic ops-manager-admin-secret  --from-literal=Username="jane.doe@example.com" --from-literal=Password="Passw0rd."  --from-literal=FirstName="Jane" --from-literal=LastName="Doe" -n mongodb
```

Note, that the secret is needed only during the initialization of the Ops Manager object - you can remove it or change the password using Ops Manager UI after the Ops Manager object was created

You will see output similar below:

```
secret/ops-manager-admin-secret created
```

### Create MongoDBOpsManager Resource

Create the configuration file ops-manager.yaml for the MongoDBOpsManager resource:

```execute
cat <<'EOF' >ops-manager.yaml
apiVersion: mongodb.com/v1
kind: MongoDBOpsManager
metadata:
  name: ops-manager
spec:
  # the number of Ops Manager instances to run. Set to value bigger
  # than 1 to get high availability and upgrades without downtime
  replicas: 3

  # the version of Ops Manager distro to use
  version: 4.2.4

  # optional. Specify the custom cluster domain of the Kubernetes cluster if it's different from the default one ('cluster.local').
  # This affects the urls generated by the Operator.
  # This field is also used for Application Database url
  # clusterDomain: mycompany.net

  # the name of the secret containing admin user credentials.
  # Either remove the secret or change the password using Ops Manager UI after the Ops Manager
  # resource is created!
  adminCredentials: ops-manager-admin-secret

  # optional. The Ops Manager configuration. All the values must be of type string
  configuration:
    mms.fromEmailAddr: "admin@thecompany.com"

  externalConnectivity:
    type: LoadBalancer

  # the application database backing Ops Manager. Replica Set is the only supported type
  # Application database has the SCRAM-SHA authentication mode always enabled
  applicationDatabase:
    members: 3
    # optional. Configures the version of MongoDB used as an application database.
    # The bundled MongoDB binary will be used if omitted and no download from the Internet will happen
    persistent: true
    # optional. Allows to pass custom MongoDB process configuration
EOF
```
Execute below command to create the object in Kubernetes:

```execute
kubectl apply -f ops-manager.yaml -n mongodb
```
The Operator will first create a Replica Set of specified size (3) which would serve as a backing database for Ops Manager. Then it will create a statefulset for Ops Manager consisting of a single pod running the Ops Manager web server. Finally, the Operator will start another statefulset of size 1 for Ops Manager Backup Daemon and will perform basic configuration for it (provisioning a persistent volume for a HeadDB which is used for backing up MongoDB versions less than 4.2). At this stage, the backup is not configured completely — this will be done in the next steps.

You will see output similar below:

```
mongodbopsmanager.mongodb.com/ops-manager created
```
Note, that it takes up to 8 minutes to initialize the Application Database and start Ops Manager.

### Confirm that the Ops Manager resource is running

Make sure the Ops Manager resource gets to the “Running” phase. Wait ~8 minutes to start it the first time:

```execute
kubectl get om -n mongodb
```

You will see output similar below:

```
NAME          REPLICAS   VERSION   STATE (OPSMANAGER)   STATE (APPDB)   STATE (BACKUP)   AGE   WARNINGS
ops-manager   3          4.4.4                                                           21m   
```

